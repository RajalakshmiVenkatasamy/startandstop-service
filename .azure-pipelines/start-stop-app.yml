trigger: none

schedules:
- cron: "0 12 * * *"  # 7 AM Toronto time = 12 PM UTC
  displayName: Start App Service Daily
  branches:
    include:
      - main
  always: true

variables:
  azureServiceConnection: "MyAzureConnection"
  resourceGroup: "myDevRG"
  appName: "mySuperWebApp"
  ACTION: "start"

pool:
  vmImage: ubuntu-latest

steps:
- task: AzureCLI@2
  displayName: "Start App Service"
  inputs:
    azureSubscription: $(azureServiceConnection)
    scriptType: bash
    scriptLocation: inlineScript
    inlineScript: |
      STATUS=$(az webapp show --resource-group $(resourceGroup) --name $(appName) --query state -o tsv)
      echo "Current App Service state: $STATUS"

      if [[ "$STATUS" == "Running" ]]; then
        echo "ðŸ”µ App Service already running."
      else
        echo "ðŸŸ¢ Starting App Service..."
        az webapp start --resource-group $(resourceGroup) --name $(appName)
        echo "âœ… App Service started."
      fi
